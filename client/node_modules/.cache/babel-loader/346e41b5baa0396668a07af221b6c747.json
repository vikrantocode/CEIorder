{"ast":null,"code":"import _classCallCheck from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _regeneratorRuntime from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{Component}from'react';import{connect}from'react-redux';import ReactDOM from'react-dom';import{Nav,NavItem,Collapse}from'reactstrap';import{NavLink,withRouter}from'react-router-dom';import classnames from'classnames';import PerfectScrollbar from'react-perfect-scrollbar';import{UserContext}from\"../../Context/UserContext\";import IntlMessages from'../../helpers/IntlMessages';import{setContainerClassnames,addContainerClassname,changeDefaultClassnames,changeSelectedMenuHasSubItems}from'../../redux/actions';import userManagement from'../../constants/menu';var getmenu=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return userManagement();case 2:data=_context.sent;return _context.abrupt(\"return\");case 4:case\"end\":return _context.stop();}}},_callee);}));return function getmenu(){return _ref.apply(this,arguments);};}();var menuItems=userManagement();var Sidebar=/*#__PURE__*/function(_Component){_inherits(Sidebar,_Component);var _super=_createSuper(Sidebar);function Sidebar(props){var _this;_classCallCheck(this,Sidebar);_this=_super.call(this,props);_this.handleWindowResize=function(event){if(event&&!event.isTrusted){return;}var containerClassnames=_this.props.containerClassnames;var nextClasses=_this.getMenuClassesForResize(containerClassnames);_this.props.setContainerClassnames(0,nextClasses.join(' '),_this.props.selectedMenuHasSubItems);};_this.handleDocumentClick=function(e){var container=_this.getContainer();var isMenuClick=false;if(e.target&&e.target.classList&&(e.target.classList.contains('menu-button')||e.target.classList.contains('menu-button-mobile'))){isMenuClick=true;}else if(e.target.parentElement&&e.target.parentElement.classList&&(e.target.parentElement.classList.contains('menu-button')||e.target.parentElement.classList.contains('menu-button-mobile'))){isMenuClick=true;}else if(e.target.parentElement&&e.target.parentElement.parentElement&&e.target.parentElement.parentElement.classList&&(e.target.parentElement.parentElement.classList.contains('menu-button')||e.target.parentElement.parentElement.classList.contains('menu-button-mobile'))){isMenuClick=true;}if(container.contains(e.target)||container===e.target||isMenuClick){return;}_this.setState({viewingParentMenu:''});_this.toggle();};_this.getMenuClassesForResize=function(classes){var _this$props=_this.props,menuHiddenBreakpoint=_this$props.menuHiddenBreakpoint,subHiddenBreakpoint=_this$props.subHiddenBreakpoint;var nextClasses=classes.split(' ').filter(function(x){return x!=='';});var windowWidth=window.innerWidth;if(windowWidth<menuHiddenBreakpoint){nextClasses.push('menu-mobile');}else if(windowWidth<subHiddenBreakpoint){nextClasses=nextClasses.filter(function(x){return x!=='menu-mobile';});if(nextClasses.includes('menu-default')&&!nextClasses.includes('menu-sub-hidden')){nextClasses.push('menu-sub-hidden');}}else{nextClasses=nextClasses.filter(function(x){return x!=='menu-mobile';});if(nextClasses.includes('menu-default')&&nextClasses.includes('menu-sub-hidden')){nextClasses=nextClasses.filter(function(x){return x!=='menu-sub-hidden';});}}return nextClasses;};_this.getContainer=function(){return ReactDOM.findDOMNode(_assertThisInitialized(_this));};_this.toggle=function(){var hasSubItems=_this.getIsHasSubItem();_this.props.changeSelectedMenuHasSubItems(hasSubItems);var _this$props2=_this.props,containerClassnames=_this$props2.containerClassnames,menuClickCount=_this$props2.menuClickCount;var currentClasses=containerClassnames?containerClassnames.split(' ').filter(function(x){return x!=='';}):'';var clickIndex=-1;if(!hasSubItems){if(currentClasses.includes('menu-default')&&(menuClickCount%4===0||menuClickCount%4===3)){clickIndex=1;}else if(currentClasses.includes('menu-sub-hidden')&&(menuClickCount===2||menuClickCount===3)){clickIndex=0;}else if(currentClasses.includes('menu-hidden')||currentClasses.includes('menu-mobile')){clickIndex=0;}}else if(currentClasses.includes('menu-sub-hidden')&&menuClickCount===3){clickIndex=2;}else if(currentClasses.includes('menu-hidden')||currentClasses.includes('menu-mobile')){clickIndex=0;}if(clickIndex>=0){_this.props.setContainerClassnames(clickIndex,containerClassnames,hasSubItems);}};_this.handleProps=function(){_this.addEvents();};_this.addEvents=function(){['click','touchstart','touchend'].forEach(function(event){return document.addEventListener(event,_this.handleDocumentClick,true);});};_this.removeEvents=function(){['click','touchstart','touchend'].forEach(function(event){return document.removeEventListener(event,_this.handleDocumentClick,true);});};_this.setSelectedLiActive=function(callback){var oldli=document.querySelector('.sub-menu  li.active');if(oldli!=null){oldli.classList.remove('active');}var oldliSub=document.querySelector('.third-level-menu  li.active');if(oldliSub!=null){oldliSub.classList.remove('active');}/* set selected parent menu */var selectedSublink=document.querySelector('.third-level-menu  a.active');if(selectedSublink!=null){selectedSublink.parentElement.classList.add('active');}var selectedlink=document.querySelector('.sub-menu  a.active');if(selectedlink!=null){selectedlink.parentElement.classList.add('active');_this.setState({selectedParentMenu:selectedlink.parentElement.parentElement.getAttribute('data-parent')},callback);}else{var selectedParentNoSubItem=document.querySelector('.main-menu  li a.active');if(selectedParentNoSubItem!=null){_this.setState({selectedParentMenu:selectedParentNoSubItem.getAttribute('data-flag')},callback);}else if(_this.state.selectedParentMenu===''){_this.setState({selectedParentMenu:menuItems[0].id},callback);}}};_this.setHasSubItemStatus=function(){var hasSubmenu=_this.getIsHasSubItem();_this.props.changeSelectedMenuHasSubItems(hasSubmenu);_this.toggle();};_this.getIsHasSubItem=function(){var selectedParentMenu=_this.state.selectedParentMenu;var menuItem=menuItems.find(function(x){return x.id===selectedParentMenu;});if(menuItem)return!!(menuItem&&menuItem.subs&&menuItem.subs.length>0);return false;};_this.openSubMenu=function(e,menuItem){var selectedParent=menuItem.id;var hasSubMenu=menuItem.subs&&menuItem.subs.length>0;_this.props.changeSelectedMenuHasSubItems(hasSubMenu);if(!hasSubMenu){_this.setState({viewingParentMenu:selectedParent,selectedParentMenu:selectedParent});_this.toggle();}else{e.preventDefault();var _this$props3=_this.props,containerClassnames=_this$props3.containerClassnames,menuClickCount=_this$props3.menuClickCount;var currentClasses=containerClassnames?containerClassnames.split(' ').filter(function(x){return x!=='';}):'';if(!currentClasses.includes('menu-mobile')){if(currentClasses.includes('menu-sub-hidden')&&(menuClickCount===2||menuClickCount===0)){_this.props.setContainerClassnames(3,containerClassnames,hasSubMenu);}else if(currentClasses.includes('menu-hidden')&&(menuClickCount===1||menuClickCount===3)){_this.props.setContainerClassnames(2,containerClassnames,hasSubMenu);}else if(currentClasses.includes('menu-default')&&!currentClasses.includes('menu-sub-hidden')&&(menuClickCount===1||menuClickCount===3)){_this.props.setContainerClassnames(0,containerClassnames,hasSubMenu);}}else{_this.props.addContainerClassname('sub-show-temporary',containerClassnames);}_this.setState({viewingParentMenu:selectedParent});}};_this.toggleMenuCollapse=function(e,menuKey){e.preventDefault();var collapsedMenus=_this.state.collapsedMenus;if(collapsedMenus.indexOf(menuKey)>-1){_this.setState({collapsedMenus:collapsedMenus.filter(function(x){return x!==menuKey;})});}else{collapsedMenus.push(menuKey);_this.setState({collapsedMenus:collapsedMenus});}return false;};_this.filteredList=function(menuItems){var currentUser=_this.props.currentUser;if(currentUser){return menuItems.filter(function(x){return x.roles&&x.roles.includes(currentUser.role)||!x.roles;});}else{return menuItems;}};_this.state={selectedParentMenu:'',viewingParentMenu:'',collapsedMenus:[]};return _this;}_createClass(Sidebar,[{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(this.props.location.pathname!==prevProps.location.pathname){this.setSelectedLiActive(this.setHasSubItemStatus);window.scrollTo(0,0);}this.handleProps();}},{key:\"componentDidMount\",value:function componentDidMount(){window.addEventListener('resize',this.handleWindowResize);this.handleWindowResize();this.handleProps();this.setSelectedLiActive(this.setHasSubItemStatus);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.removeEvents();window.removeEventListener('resize',this.handleWindowResize);}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,selectedParentMenu=_this$state.selectedParentMenu,viewingParentMenu=_this$state.viewingParentMenu,collapsedMenus=_this$state.collapsedMenus;return/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"main-menu\"},/*#__PURE__*/React.createElement(\"div\",{className:\"scroll\"},/*#__PURE__*/React.createElement(PerfectScrollbar,{options:{suppressScrollX:true,wheelPropagation:false}},/*#__PURE__*/React.createElement(Nav,{vertical:true,className:\"list-unstyled\"},menuItems&&this.filteredList(menuItems).map(function(item){return/*#__PURE__*/React.createElement(NavItem,{key:item.id,className:classnames({active:selectedParentMenu===item.id&&viewingParentMenu===''||viewingParentMenu===item.id})},item.newWindow?/*#__PURE__*/React.createElement(\"a\",{href:item.to,rel:\"noopener noreferrer\",target:\"_blank\"},/*#__PURE__*/React.createElement(\"i\",{className:item.icon}),' ',/*#__PURE__*/React.createElement(IntlMessages,{id:item.label})):/*#__PURE__*/React.createElement(NavLink,{to:item.to,onClick:function onClick(e){return _this2.openSubMenu(e,item);},\"data-flag\":item.id},/*#__PURE__*/React.createElement(\"i\",{className:item.icon}),' ',/*#__PURE__*/React.createElement(IntlMessages,{id:item.label})));}))))),/*#__PURE__*/React.createElement(\"div\",{className:\"sub-menu\"},/*#__PURE__*/React.createElement(\"div\",{className:\"scroll\"},/*#__PURE__*/React.createElement(PerfectScrollbar,{options:{suppressScrollX:true,wheelPropagation:false}},menuItems&&this.filteredList(menuItems).map(function(item){return/*#__PURE__*/React.createElement(Nav,{key:item.id,className:classnames({'d-block':_this2.state.selectedParentMenu===item.id&&_this2.state.viewingParentMenu===''||_this2.state.viewingParentMenu===item.id}),\"data-parent\":item.id},item.subs&&_this2.filteredList(item.subs).map(function(sub,index){return/*#__PURE__*/React.createElement(NavItem,{key:\"\".concat(item.id,\"_\").concat(index),className:\"\".concat(sub.subs&&sub.subs.length>0?'has-sub-item':'')},sub.newWindow?/*#__PURE__*/React.createElement(\"a\",{href:sub.to,rel:\"noopener noreferrer\",target:\"_blank\"},/*#__PURE__*/React.createElement(\"i\",{className:sub.icon}),' ',/*#__PURE__*/React.createElement(IntlMessages,{id:sub.label})):sub.subs&&sub.subs.length>0?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(NavLink,{className:\"rotate-arrow-icon opacity-50 \".concat(collapsedMenus.indexOf(\"\".concat(item.id,\"_\").concat(index))===-1?'':'collapsed'),to:sub.to,id:\"\".concat(item.id,\"_\").concat(index),onClick:function onClick(e){return _this2.toggleMenuCollapse(e,\"\".concat(item.id,\"_\").concat(index));}},/*#__PURE__*/React.createElement(\"i\",{className:\"simple-icon-arrow-down\"}),' ',/*#__PURE__*/React.createElement(IntlMessages,{id:sub.label})),/*#__PURE__*/React.createElement(Collapse,{isOpen:collapsedMenus.indexOf(\"\".concat(item.id,\"_\").concat(index))===-1},/*#__PURE__*/React.createElement(Nav,{className:\"third-level-menu\"},_this2.filteredList(sub.subs).map(function(thirdSub,thirdIndex){return/*#__PURE__*/React.createElement(NavItem,{key:\"\".concat(item.id,\"_\").concat(index,\"_\").concat(thirdIndex)},thirdSub.newWindow?/*#__PURE__*/React.createElement(\"a\",{href:thirdSub.to,rel:\"noopener noreferrer\",target:\"_blank\"},/*#__PURE__*/React.createElement(\"i\",{className:thirdSub.icon}),' ',/*#__PURE__*/React.createElement(IntlMessages,{id:thirdSub.label})):/*#__PURE__*/React.createElement(NavLink,{to:thirdSub.to},/*#__PURE__*/React.createElement(\"i\",{className:thirdSub.icon}),' ',/*#__PURE__*/React.createElement(IntlMessages,{id:thirdSub.label})));})))):/*#__PURE__*/React.createElement(NavLink,{to:sub.to},/*#__PURE__*/React.createElement(\"i\",{className:sub.icon}),' ',/*#__PURE__*/React.createElement(IntlMessages,{id:sub.label})));}));})))));}}]);return Sidebar;}(Component);var mapStateToProps=function mapStateToProps(_ref2){var menu=_ref2.menu,authUser=_ref2.authUser;var containerClassnames=menu.containerClassnames,subHiddenBreakpoint=menu.subHiddenBreakpoint,menuHiddenBreakpoint=menu.menuHiddenBreakpoint,menuClickCount=menu.menuClickCount,selectedMenuHasSubItems=menu.selectedMenuHasSubItems;var currentUser=authUser.currentUser;return{containerClassnames:containerClassnames,subHiddenBreakpoint:subHiddenBreakpoint,menuHiddenBreakpoint:menuHiddenBreakpoint,menuClickCount:menuClickCount,selectedMenuHasSubItems:selectedMenuHasSubItems,currentUser:currentUser};};export default withRouter(connect(mapStateToProps,{setContainerClassnames:setContainerClassnames,addContainerClassname:addContainerClassname,changeDefaultClassnames:changeDefaultClassnames,changeSelectedMenuHasSubItems:changeSelectedMenuHasSubItems})(Sidebar));","map":null,"metadata":{},"sourceType":"module"}