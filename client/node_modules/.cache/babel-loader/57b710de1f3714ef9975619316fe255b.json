{"ast":null,"code":"import _objectSpread from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{Row,Button,Col,Input,Label,Card,CardBody,Form,FormGroup,Modal,ModalHeader,ModalBody,ModalFooter,Table}from'reactstrap';import axios from'axios';import{useHistory}from'react-router';import{Colxx,Separator}from'../../../../components/common/CustomBootstrap';import Breadcrumb from'../../../../containers/navs/Breadcrumb';import IntlMessages from'../../../../helpers/IntlMessages';import{NotificationManager}from'../../../../components/common/react-notifications';var AddCustomer=function AddCustomer(_ref){var match=_ref.match;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),customerModel=_useState4[0],setCustomerModel=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoaded=_useState6[0],setIsLoaded=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),data=_useState8[0],setData=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),change=_useState10[0],setChange=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),id=_useState12[0],setId=_useState12[1];var history=useHistory();var validateEmail=function validateEmail(email){var re=/\\S+@\\S+\\.\\S+/;return re.test(email);};var validateUsername=function validateUsername(username){var usernameRegex=/^(?=.*[!@#$%_^&*]).{8,64}$/;return usernameRegex.test(username);};var validate=function validate(formData){if(!formData.username)return NotificationManager.warning('Username is Mandatory','Validation Error',3000);else if(!validateUsername(formData.username))return NotificationManager.warning('Valid Username Must have Special Character in it and 8 letters Long.','Validation Error',6000);if(!formData.firstName)return NotificationManager.warning('FirstName is Mandatory','Validation Error',3000);else if(formData.firstName.length<3)return NotificationManager.warning('FirstName must be At least 3 Characters Long','Validation Error',3000);if(!formData.email){return NotificationManager.warning('Email is Mandatory','Validation Error',3000);}else{if(!validateEmail(formData.email))return NotificationManager.warning('Please Enter a Valid Email','Validation Error',3000);}if(formData.emailCC){if(!validateEmail(formData.emailCC))return NotificationManager.warning('Please Enter a Valid Email CC','Validation Error',3000);}return true;};var handleSave=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!id){_context.next=20;break;}if(formData.username===undefined)formData.username=data.username;if(formData.email===undefined)formData.email=data.email;if(formData.firstName===undefined)formData.firstName=data.firstName;if(validate(formData)){_context.next=7;break;}return _context.abrupt(\"return\");case 7:_context.prev=7;_context.next=10;return axios.post(\"/api/customers/update/\".concat(id),formData);case 10:NotificationManager.success('Customer Updated Successfully.','Success',3000);history.push('/app/customers');_context.next=18;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](7);console.log(JSON.stringify(_context.t0.response,null,4));if(_context.t0.response.status<500)NotificationManager.error(\"\".concat(_context.t0.response.data.field[0].toUpperCase()+_context.t0.response.data.field.slice(1),\" is Already Taken.\"),'Error',3000);else{NotificationManager.error('Something Went Wrong!!!','Error',3000);}case 18:_context.next=33;break;case 20:if(validate(formData)){_context.next=22;break;}return _context.abrupt(\"return\");case 22:_context.prev=22;_context.next=25;return axios.post(\"/api/customers/\",formData);case 25:NotificationManager.success('Customer Created Successfully.','Success',3000);history.push('/app/customers');_context.next=33;break;case 29:_context.prev=29;_context.t1=_context[\"catch\"](22);console.log(JSON.stringify(_context.t1.response,null,4));if(_context.t1.response.status<500)NotificationManager.error(\"\".concat(_context.t1.response.data.field[0].toUpperCase()+_context.t1.response.data.field.slice(1),\" is Already Taken.\"),'Error',3000);else{NotificationManager.error('Something Went Wrong!!!','Error',3000);}case 33:case\"end\":return _context.stop();}}},_callee,null,[[7,14],[22,29]]);}));return function handleSave(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){if(match.params.id){setIsLoaded(false);setId(match.params.id);axios.get(\"/api/customers/details/\".concat(match.params.id)).then(function(res){console.log(res.data);setData(res.data.customer);setIsLoaded(true);}).catch(function(err){console.log(err.response);return NotificationManager.error('Something Went Wrong!!!','Error',3000);});}},[change]);return!isLoaded?/*#__PURE__*/React.createElement(\"div\",{className:\"loading\"}):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Colxx,{xxs:\"12\"},/*#__PURE__*/React.createElement(Breadcrumb,{heading:id?'Edit Customer':'Add Customer',match:match}),/*#__PURE__*/React.createElement(\"div\",{className:\"text-zero top-right-button-container\"},/*#__PURE__*/React.createElement(Button,{color:\"danger\",size:\"lg\",outline:true,className:\"top-right-button\",onClick:function onClick(){history.push('/app/customers');}},/*#__PURE__*/React.createElement(IntlMessages,{id:\"Cancel\"})),'  '),/*#__PURE__*/React.createElement(Separator,{className:\"mb-5\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-column\"},/*#__PURE__*/React.createElement(Row,{className:\"mb-4\"},/*#__PURE__*/React.createElement(Colxx,{xxs:\"12\"},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(Colxx,{xxs:\"12\",className:\"mb-5\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"mb-4\"},id?\"Edit Customer Form\":\"Create Customer Form\"),/*#__PURE__*/React.createElement(Form,null,/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Row,{className:\"mt-3\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Username\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.username,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{username:e.target.value}));}})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"First Name\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.firstName,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{firstName:e.target.value}));}})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Last Name\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.lastName,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{lastName:e.target.value}));}}))),/*#__PURE__*/React.createElement(Row,{className:\"mt-3\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Email\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.email,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));}})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Email CC\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.emailCC,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{emailCC:e.target.value}));}})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Phone\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.phone,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{phone:e.target.value}));}}))),/*#__PURE__*/React.createElement(Row,{className:\"mt-3\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Business Name\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.businessName,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{businessName:e.target.value}));}})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Credit Term\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.creditTerm,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{creditTerm:e.target.value}));}})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Credit Limit\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.creditLimit,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{creditLimit:e.target.value}));}}))),/*#__PURE__*/React.createElement(Row,{className:\"mt-3\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"User Phone 1\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.userPhone1,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{userPhone1:e.target.value}));}})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"User Phone 2\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.userPhone2,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{userPhone2:e.target.value}));}})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"User Phone 3\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.userPhone3,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{userPhone3:e.target.value}));}}))),/*#__PURE__*/React.createElement(Row,{className:\"mt-3\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Address 1\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.address1,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{address1:e.target.value}));},type:\"textarea\"})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Address 2\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.address2,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{address2:e.target.value}));},type:\"textarea\"}))),/*#__PURE__*/React.createElement(Row,{className:\"mt-3\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"City\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.city,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{city:e.target.value}));}})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"State\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.state,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{state:e.target.value}));}}))),/*#__PURE__*/React.createElement(Row,{className:\"mt-3\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Country\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.country,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{country:e.target.value}));}})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Zip Code\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:data.zipCode,onChange:function onChange(e){setFormData(_objectSpread(_objectSpread({},formData),{},{zipCode:e.target.value}));}})))),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\"},/*#__PURE__*/React.createElement(Button,{className:\"mr-2\",color:\"secondary\",outline:true,onClick:function onClick(){history.push('/app/customers');}},/*#__PURE__*/React.createElement(IntlMessages,{id:\"Cancel\"})),/*#__PURE__*/React.createElement(Button,{color:\"primary\",onClick:handleSave},/*#__PURE__*/React.createElement(IntlMessages,{id:id?'Update Customer':'Create Customer'})))))))))),/*#__PURE__*/React.createElement(Modal,{isOpen:customerModel},/*#__PURE__*/React.createElement(ModalHeader,null,\"Add New Customer\"),/*#__PURE__*/React.createElement(ModalBody,null,\"Body\"),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(Button,{className:\"mr-2\",color:\"secondary\",outline:true,onClick:function onClick(){setCustomerModel(false);}},/*#__PURE__*/React.createElement(IntlMessages,{id:\"Cancel\"})),/*#__PURE__*/React.createElement(Button,{color:\"primary\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"Create Customer\"})))));};export default AddCustomer;","map":null,"metadata":{},"sourceType":"module"}