{"ast":null,"code":"import _toConsumableArray from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import axios from'axios';import VendorListHeading from'./VendorListHeading';import VendorPageListing from'./VendorPageListing';import VendorPageHeading from'./VendorPageHeading';import AddNewVendor from'./add-new-vendor';import{Button,Modal,ModalHeader,ModalBody,ModalFooter,Input,Label}from'reactstrap';import{NotificationManager}from'../../../../components/common/react-notifications';import IntlMessages from'../../../../helpers/IntlMessages';var orderManners=[{value:'ASC',label:'Ascending'},{value:'DESC',label:'Descending'}];var Vendor=function Vendor(_ref){var match=_ref.match;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoaded=_useState2[0],setIsLoaded=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),vendorId=_useState4[0],setVendorId=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),modalBasic=_useState6[0],setModalBasic=_useState6[1];var _useState7=useState('thumblist'),_useState8=_slicedToArray(_useState7,2),displayMode=_useState8[0],setDisplayMode=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),selectedItems=_useState10[0],setSelectedItems=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),lastChecked=_useState12[0],setLastChecked=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),searchElement=_useState14[0],setSearchElement=_useState14[1];var _useState15=useState({column:'id',label:'Id'}),_useState16=_slicedToArray(_useState15,2),order=_useState16[0],setOrder=_useState16[1];var _useState17=useState({value:'ASC',label:'Ascending'}),_useState18=_slicedToArray(_useState17,2),manner=_useState18[0],setManner=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),items=_useState20[0],setItems=_useState20[1];var _useState21=useState(1),_useState22=_slicedToArray(_useState21,2),totalPage=_useState22[0],setTotalPage=_useState22[1];var _useState23=useState(1),_useState24=_slicedToArray(_useState23,2),currentPage=_useState24[0],setCurrentPage=_useState24[1];var _useState25=useState(15),_useState26=_slicedToArray(_useState25,2),selectedPageSize=_useState26[0],setSelectedPageSize=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),importModal=_useState28[0],setImportModal=_useState28[1];var _useState29=useState(false),_useState30=_slicedToArray(_useState29,2),modalOpen=_useState30[0],setModalOpen=_useState30[1];var _useState31=useState(false),_useState32=_slicedToArray(_useState31,2),modal=_useState32[0],setModal=_useState32[1];var _useState33=useState(false),_useState34=_slicedToArray(_useState33,2),change=_useState34[0],setchange=_useState34[1];var _useState35=useState(0),_useState36=_slicedToArray(_useState35,2),totalItemCount=_useState36[0],setTotalItemCount=_useState36[1];var _React$useState=React.useState({}),_React$useState2=_slicedToArray(_React$useState,2),formData=_React$useState2[0],setformData=_React$useState2[1];var _useState37=useState({}),_useState38=_slicedToArray(_useState37,2),details=_useState38[0],setDetails=_useState38[1];var _useState39=useState(false),_useState40=_slicedToArray(_useState39,2),modalDelete=_useState40[0],setModalDelete=_useState40[1];useEffect(function(){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:axios.get(\"/api/inventory/get-vendors/1?pagesize=\".concat(selectedPageSize,\"&searchItem=\").concat(searchElement,\"&orderBy=\").concat(order.column,\"&orderManner=\").concat(manner.value)).then(function(res){var data=res.data;console.log(data);setTotalPage(data.totalPage);setItems(data.data.map(function(x){return _objectSpread({},x);}));setSelectedItems([]);setTotalItemCount(data.all);setIsLoaded(true);});case 1:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();return function(){setIsLoaded(false);};},[change]);var deleteModal=function deleteModal(e){setVendorId(e);setModalBasic(true);};// GET THE Vendor DETAILS AND OPEN THE EDIT MODAL\nvar openModal=function openModal(e){axios.get('/api/inventory/vendors',{params:{id:e}}).then(function(res){if(res.data.data){console.log(res.data.data);setDetails(res.data.data);setModal(true);}});setVendorId(e);};var getIndex=function getIndex(value,arr,prop){for(var i=0;i<arr.length;i+=1){if(arr[i][prop]===value){return i;}}return-1;};var onCheckItem=function onCheckItem(event,id){if(event.target.tagName==='A'||event.target.parentElement&&event.target.parentElement.tagName==='A'){return true;}if(lastChecked===null){setLastChecked(id);}var selectedList=_toConsumableArray(selectedItems);if(selectedList.includes(id)){selectedList=selectedList.filter(function(x){return x!==id;});}else{selectedList.push(id);}setSelectedItems(selectedList);if(event.shiftKey){var newItems=_toConsumableArray(items);var start=getIndex(id,newItems,'id');var end=getIndex(lastChecked,newItems,'id');newItems=newItems.slice(Math.min(start,end),Math.max(start,end)+1);selectedItems.push.apply(selectedItems,_toConsumableArray(newItems.map(function(item){return item.id;})));selectedList=Array.from(new Set(selectedItems));setSelectedItems(selectedList);}document.activeElement.blur();return false;};var onContextMenuClick=function onContextMenuClick(e,data){// params : (e,data,target)\nconsole.log('onContextMenuClick - selected items',selectedItems);console.log('onContextMenuClick - action : ',data.action);};var onContextMenu=function onContextMenu(e,data){var clickedVendorId=data.data;if(!selectedItems.includes(clickedVendorId)){setSelectedItems([clickedVendorId]);}return true;};var handleChangeSelectAll=function handleChangeSelectAll(isToggle){if(selectedItems.length>=items.length){if(isToggle){setSelectedItems([]);}}else{setSelectedItems(items.map(function(x){return x.id;}));}document.activeElement.blur();return false;};var changePage=function changePage(i,size){setCurrentPage(i);axios.get(\"/api/inventory/get-vendors/\".concat(i,\"?pagesize=\").concat(selectedPageSize,\"&searchItem=\").concat(searchElement,\"&orderBy=\").concat(order.column,\"&orderManner=\").concat(manner.value)).then(function(res){setTotalPage(res.data.totalPage);setItems(res.data.data.map(function(x){return _objectSpread({},x);}));setSelectedItems([]);// setTotalItemCount(data.totalItem);\nsetIsLoaded(true);//setSelectedPageSize(15);\n});};//DELETE CATEGORY HANDLER\nvar deleteVendor=function deleteVendor(e){axios.post('/api/inventory/destroy-vendors',null,{params:{id:vendorId}}).then(function(res){setchange(!change);setModalBasic(false);NotificationManager.success(res.data.success,'Success',3000,null,null,'');});};var deleteMultipleModal=function deleteMultipleModal(e){setModalDelete(true);};// DELETE MULTIPLE vendor\nvar deleteMultiple=function deleteMultiple(){axios.post('/api/inventory/destroy-vendors',null,{params:{id:selectedItems}}).then(function(res){console.log(res.data);setchange(!change);setModalDelete(false);NotificationManager.success(res.data.success,'Success',3000,null,null,'');});};// edit vendor\nvar edit=function edit(){axios.post('/api/inventory/edit-vendor',formData,{params:{id:vendorId}}).then(function(res){console.log(res);setchange(!change);setModal(false);NotificationManager.success(res.data.success,'Success',3000,null,null,'');});};var onchangePagesize=function onchangePagesize(size){setCurrentPage(1);console.log(selectedPageSize);axios.get(\"/api/inventory/get-vendors/\".concat(1,\"?pagesize=\",size,\"&orderBy=\").concat(order.column,\"&orderManner=\").concat(manner.value)).then(function(res){setTotalPage(res.data.totalPage);setItems(res.data.data.map(function(x){return _objectSpread({},x);}));setSelectedItems([]);// setTotalItemCount(data.totalItem);\nsetIsLoaded(true);});};var startIndex=(currentPage-1)*selectedPageSize;var endIndex=currentPage*selectedPageSize;var pageSizes=[15,50,100,150,200];var heading='Vendors';return!isLoaded?/*#__PURE__*/React.createElement(\"div\",{className:\"loading\"}):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"disable-text-selection\"},/*#__PURE__*/React.createElement(VendorPageHeading,{heading:heading,onchangepagesize:onchangePagesize,deleteMultipleModal:deleteMultipleModal,match:match,setImportModal:setImportModal,toggleModal:function toggleModal(){return setModalOpen(!modalOpen);},totalItemCount:totalItemCount,startIndex:startIndex,endIndex:endIndex,pageSizes:pageSizes,changePageSize:setSelectedPageSize,selectedPageSize:selectedPageSize,handleChangeSelectAll:handleChangeSelectAll,selectedItemsLength:selectedItems?selectedItems.length:0,itemsLength:items?items.length:0,onSearchKey:/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(e.key==='Enter'){setSearchElement(e.target.value);axios.get(\"/api/inventory/get-vendors/\".concat(1,\"?pagesize=\",selectedPageSize,\"&searchItem=\").concat(e.target.value,\"&orderBy=\").concat(order.column,\"&orderManner=\").concat(manner.value)).then(function(res){setTotalItemCount(res.data.all);setTotalPage(res.data.totalPage);setItems(res.data.data.map(function(x){return _objectSpread({},x);}));// setTotalItemCount(data.totalItem);\n});}case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}(),setchange:setchange,change:change,order:order,manner:manner,changeOrderBy:/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(ord){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setOrder(ord);axios.get(\"/api/inventory/get-vendors/\".concat(1,\"?pagesize=\",selectedPageSize,\"&searchItem=\").concat(searchElement,\"&orderBy=\").concat(ord.column,\"&orderManner=\").concat(manner.value)).then(function(res){setTotalItemCount(res.data.all);setTotalPage(res.data.totalPage);setItems(res.data.data.map(function(x){return _objectSpread({},x);}));// setTotalItemCount(data.totalItem);\n});case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref3.apply(this,arguments);};}(),changeOrderManner:/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(man){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setManner(man);axios.get(\"/api/inventory/get-vendors/\".concat(1,\"?pagesize=\",selectedPageSize,\"&searchItem=\").concat(searchElement,\"&orderBy=\").concat(order.column,\"&orderManner=\").concat(man.value)).then(function(res){setTotalItemCount(res.data.all);setTotalPage(res.data.totalPage);setItems(res.data.data.map(function(x){return _objectSpread({},x);}));// setTotalItemCount(data.totalItem);\n});case 2:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x3){return _ref4.apply(this,arguments);};}()}),/*#__PURE__*/React.createElement(AddNewVendor,{modalOpen:modalOpen,toggleModal:function toggleModal(){return setModalOpen(!modalOpen);}//categories={categories}\n,change:change,setchange:setchange}),items.length==0?'':/*#__PURE__*/React.createElement(VendorListHeading,{selectedItemsLength:selectedItems?selectedItems.length:0,handleChangeSelectAll:handleChangeSelectAll,itemsLength:items?items.length:0,order:order,manner:manner,changeOrderBy:/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(ord){var ind;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setOrder(ord);if(order.column===ord.column){ind=!orderManners.findIndex(function(man){return man.value===manner.value;});setManner(orderManners[ind?1:0]);axios.get(\"/api/inventory/get-vendors/\".concat(1,\"?pagesize=\",selectedPageSize,\"&searchItem=\").concat(searchElement,\"&orderBy=\").concat(ord.column,\"&orderManner=\").concat(orderManners[ind?1:0].value)).then(function(res){setTotalItemCount(res.data.all);setTotalPage(res.data.totalPage);setItems(res.data.data.map(function(x){return _objectSpread({},x);}));// setTotalItemCount(data.totalItem);\n});}else{setManner(orderManners[0]);axios.get(\"/api/inventory/get-vendors/\".concat(1,\"?pagesize=\",selectedPageSize,\"&searchItem=\").concat(searchElement,\"&orderBy=\").concat(ord.column,\"&orderManner=\").concat(orderManners[0].value)).then(function(res){setTotalItemCount(res.data.all);setTotalPage(res.data.totalPage);setItems(res.data.data.map(function(x){return _objectSpread({},x);}));// setTotalItemCount(data.totalItem);\n});}case 2:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x4){return _ref5.apply(this,arguments);};}()}),items.length==0?/*#__PURE__*/React.createElement(\"h3\",null,\"No Records found\"):/*#__PURE__*/React.createElement(VendorPageListing,{items:items,deleteModal:deleteModal,openModal:openModal,displayMode:displayMode,selectedItems:selectedItems,onCheckItem:onCheckItem,currentPage:currentPage,totalPage:totalPage,onContextMenuClick:onContextMenuClick,onContextMenu:onContextMenu,onChangePage:changePage,setVendorId:setVendorId,pagesize:selectedPageSize,match:match,searchElement:searchElement}),/*#__PURE__*/React.createElement(Modal,{isOpen:modal,toggle:function toggle(){return setModal(!modal);}},/*#__PURE__*/React.createElement(ModalHeader,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Edit\"})),/*#__PURE__*/React.createElement(ModalBody,null,/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\"},/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Vendor Abbreviation\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:details.vendorAbbreviation,onChange:function onChange(e){setformData(_objectSpread(_objectSpread({},formData),{},{vendorAbbreviation:e.target.value}));}})),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\"},/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Vendor Short Name\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:details.vendorShortName,onChange:function onChange(e){setformData(_objectSpread(_objectSpread({},formData),{},{vendorShortName:e.target.value}));}})),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\"},/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Vendor Pricer Print Name\"})),/*#__PURE__*/React.createElement(Input,{defaultValue:details.vendorPricerPrintName,onChange:function onChange(e){setformData(_objectSpread(_objectSpread({},formData),{},{vendorPricerPrintName:e.target.value}));}}))),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(Button,{onClick:edit,color:\"primary\"},\"Save Changes\"),' ',/*#__PURE__*/React.createElement(Button,{color:\"secondary\",onClick:function onClick(){return setModal(false);}},\"Cancel\"))),/*#__PURE__*/React.createElement(Modal,{isOpen:modalBasic,toggle:function toggle(){return setModal(!modalBasic);}},/*#__PURE__*/React.createElement(ModalHeader,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Delete\"})),/*#__PURE__*/React.createElement(ModalBody,null,\"Are you sure you want to delete Vendor?\"),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(Button,{onClick:deleteVendor,color:\"primary\"},\"Confirm\"),' ',/*#__PURE__*/React.createElement(Button,{color:\"secondary\",onClick:function onClick(){return setModalBasic(false);}},\"Cancel\"))),/*#__PURE__*/React.createElement(Modal,{isOpen:modalDelete,toggle:function toggle(){return setModal(!modalDelete);}},/*#__PURE__*/React.createElement(ModalHeader,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Delete\"})),/*#__PURE__*/React.createElement(ModalBody,null,\"Are you sure you want to delete selected items?\"),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(Button,{onClick:deleteMultiple,color:\"primary\"},\"Confirm\"),' ',/*#__PURE__*/React.createElement(Button,{color:\"secondary\",onClick:function onClick(){return setModalDelete(false);}},\"Cancel\")))));};export default Vendor;","map":null,"metadata":{},"sourceType":"module"}