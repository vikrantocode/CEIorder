{"ast":null,"code":"import _objectSpread from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _this=this;import React,{useState,useEffect,use}from'react';import{Row,Card,CardTitle,Label,FormGroup,Button}from'reactstrap';import{NavLink}from'react-router-dom';import{connect}from'react-redux';import{Formik,Form,Field}from'formik';import{NotificationManager}from'../../components/common/react-notifications';import{loginUser}from'../../redux/actions';import{Colxx}from'../../components/common/CustomBootstrap';import IntlMessages from'../../helpers/IntlMessages';import{GoogleLogin}from'react-google-login';import axios from'axios';// const validatePassword = (value) => {\n//   let error;\n//   if (!value) {\n//     error = 'Please enter your password';\n//   } else if (value.length < 8) {\n//     error = 'Value must be longer than 8 characters';\n//   }\n//   return error;\n// };\nvar styles={divStyle:{margin:'1rem'}};function InvalidMsg(textbox){if(textbox.value.length<8){textbox.setCustomValidity('Password should be minimum 8 characters');}else{textbox.setCustomValidity('');}return true;}var validateEmail=function validateEmail(value){var error;if(!value){error='Please enter your email address';}else if(!/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i.test(value)){error='Invalid email address';}return error;};var Login=function Login(_ref){var history=_ref.history,loading=_ref.loading,error=_ref.error,loginUserAction=_ref.loginUserAction;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setformData=_useState2[1];// WHEN GOOGLE LOGIN IS SUCCESSFULL\nvar onSuccessGoogle=function onSuccessGoogle(response){console.log(response);axios.post('/api/googleLogin',{tokenId:response.tokenId}).then(function(response){if(response.data.token){localStorage.setItem('user',JSON.stringify(response.data));localStorage.setItem('auth-token',response.data.token);// setAlert({ success: response.data.success })\nhistory.push('/app');}else if(response.data.error){console.log(response.data.error);// setAlert({ error: response.data.error })\n// setOpen(true)\n}});};// IF GOOGLE LOGIN IS NOT SUCCESSFUL\nvar onFailureGoogle=function onFailureGoogle(response){console.log(response);};useEffect(function(){if(error){NotificationManager.warning(error,'Login Error',3000,null,null,'');}},[error]);// const onUserLogin = (values) => {\n//   if (!loading) {\n//     if (values.email !== '' && values.password !== '') {\n//       loginUserAction(values, history);\n//     }\n//   }\n// };\n//LOGIN HANDLER\nvar onUserLogin=function onUserLogin(e){e.preventDefault();var data=formData;axios.post('/api/login',data).then(function(response){console.log(response.data);if(response.data.token){localStorage.setItem('user',JSON.stringify(response.data));localStorage.setItem('userId',response.data.user.id);localStorage.setItem('auth-token',response.data.token);history.push('/app');}else if(response.data.error){NotificationManager.warning(response.data.error,'Login Error',3000,null,null,'');}});};// const initialValues = { email, password };\nreturn/*#__PURE__*/React.createElement(Row,{className:\"h-100\"},/*#__PURE__*/React.createElement(Colxx,{xxs:\"12\",md:\"10\",className:\"mx-auto my-auto\"},/*#__PURE__*/React.createElement(Card,{className:\"auth-card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"position-relative image-side \"},/*#__PURE__*/React.createElement(\"p\",{className:\"text-white h2\"},\"MAGIC IS IN THE DETAILS\"),/*#__PURE__*/React.createElement(\"p\",{className:\"white mb-0\"},\"Please use your credentials to login.\",/*#__PURE__*/React.createElement(\"br\",null),\"If you are not a member, please\",' ',/*#__PURE__*/React.createElement(NavLink,{to:\"/user/register\",className:\"white\"},\"register\"),\".\")),/*#__PURE__*/React.createElement(\"div\",{className:\"form-side\"},/*#__PURE__*/React.createElement(\"div\",{style:{fontSize:'2.5rem'}},\"BUY SUPPLY APP\"),/*#__PURE__*/React.createElement(CardTitle,{className:\"mb-4\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"user.login-title\"})),/*#__PURE__*/React.createElement(Formik,null,/*#__PURE__*/React.createElement(Form,{className:\"av-tooltip tooltip-label-bottom\"},/*#__PURE__*/React.createElement(FormGroup,{className:\"form-group has-float-label\"},/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"user.email\"})),/*#__PURE__*/React.createElement(Field,{className:\"form-control\",name:\"email\",validate:validateEmail,onChange:function onChange(e){setformData(_objectSpread(_objectSpread({},formData),{},{email:e.target.value}));}})),/*#__PURE__*/React.createElement(FormGroup,{className:\"form-group has-float-label\"},/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"user.password\"})),/*#__PURE__*/React.createElement(Field,{onChange:function onChange(e){setformData(_objectSpread(_objectSpread({},formData),{},{password:e.target.value}));},className:\"form-control\",type:\"password\",name:\"password\",oninput:function oninput(){return InvalidMsg(_this);},onvalid:function onvalid(){return InvalidMsg(_this);}})),/*#__PURE__*/React.createElement(\"div\",{style:styles.divStyle,className:\"d-flex justify-content-center align-items-center\"},\"OR\"),/*#__PURE__*/React.createElement(\"div\",{style:styles.divStyle,className:\"d-flex justify-content-center align-items-center\"},/*#__PURE__*/React.createElement(GoogleLogin,{clientId:\"501516992284-icth2bhte5iu6fpskcd97hcia62f9qdd.apps.googleusercontent.com\"// render={renderProps => (\n//   <button onClick={renderProps.onClick} style={{background:'red',height:'2rem',width:'8rem'}}>Login with google</button>\n// )}\n,buttonText:\"Login with Google\",onSuccess:onSuccessGoogle,onFailure:onFailureGoogle,cookiePolicy:'single_host_origin'})),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-between align-items-center\"},/*#__PURE__*/React.createElement(NavLink,{to:\"/user/forgot-password\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"user.forgot-password-question\"})),/*#__PURE__*/React.createElement(NavLink,{to:\"/user/register\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"Create an Account\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex justify-content-center align-items-center\"},/*#__PURE__*/React.createElement(Button,{onClick:onUserLogin,color:\"primary\",className:\"btn-shadow btn-multiple-state \".concat(loading?'show-spinner':''),size:\"lg\"},/*#__PURE__*/React.createElement(\"span\",{className:\"spinner d-inline-block\"},/*#__PURE__*/React.createElement(\"span\",{className:\"bounce1\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"bounce2\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"bounce3\"})),/*#__PURE__*/React.createElement(\"span\",{className:\"label\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"user.login-button\"}))))))))));};var mapStateToProps=function mapStateToProps(_ref2){var authUser=_ref2.authUser;var loading=authUser.loading,error=authUser.error;return{loading:loading,error:error};};export default connect(mapStateToProps,{loginUserAction:loginUser})(Login);","map":null,"metadata":{},"sourceType":"module"}