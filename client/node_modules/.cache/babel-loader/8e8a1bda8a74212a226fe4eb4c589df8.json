{"ast":null,"code":"import _objectSpread from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _createForOfIteratorHelper from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/browsewire/Desktop/CEI/cei/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Button,Modal,ModalHeader,ModalBody,ModalFooter,Input,Label,Row,Col}from'reactstrap';import Select from'react-select';import IntlMessages from'../../../../helpers/IntlMessages';import axios from'axios';import CustomSelectInput from'../../../../components/common/CustomSelectInput';import{NotificationManager}from'../../../../components/common/react-notifications';var styles={profileImg:{height:'3rem',width:'3rem',borderRadius:'50%'}};var statusOptions=[{label:'Active',value:'Active',key:0},{label:'Inactive',value:'Inactive',key:1}];var AddNewCategoryModal=function AddNewCategoryModal(_ref){var modalOpen=_ref.modalOpen,toggleModal=_ref.toggleModal,categories=_ref.categories,change=_ref.change,setchange=_ref.setchange;var _React$useState=React.useState({}),_React$useState2=_slicedToArray(_React$useState,2),formData=_React$useState2[0],setformData=_React$useState2[1];var _useState=useState([]),_useState2=_slicedToArray(_useState,2),parentcategories=_useState2[0],setParentcategories=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),categoryImage=_useState4[0],setCategoryImage=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),categoryImagedata=_useState6[0],setCategoryImagedata=_useState6[1];var baseimageurl='https://cdn.linqusacorp.com';var createCategory=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var form,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(formData.name){_context.next=3;break;}return _context.abrupt(\"return\",NotificationManager.warning('Name is Mandatory','Warning',3000));case 3:if(!categoryImagedata){_context.next=25;break;}form=new FormData();form.append('categoryimg',categoryImagedata);form.append('name',formData.name);form.append('parentId',formData.parentId);form.append('status',formData.status);_context.prev=9;_context.next=12;return axios.post('/api/inventory/add-Category',form);case 12:_yield$axios$post=_context.sent;data=_yield$axios$post.data;console.log(data);setchange(!change);NotificationManager.success('Category Created','Success',3000,null,null,'');toggleModal();setformData({});_context.next=25;break;case 21:_context.prev=21;_context.t0=_context[\"catch\"](9);console.log(_context.t0);NotificationManager.error('Something Went Wrong!','Error',3000,null,null,'');case 25:case\"end\":return _context.stop();}}},_callee,null,[[9,21]]);}));return function createCategory(_x){return _ref2.apply(this,arguments);};}();// Create new Category\nvar CreateNewCategory=function CreateNewCategory(e){e.preventDefault();if(categoryImagedata){var imgform=new FormData();imgform.append('categoryimg',categoryImagedata);axios.post('https://cdn.linqusacorp.com/categoryimage',imgform).then(function(data){//axios.post(\"http://localhost:3001/categoryimage\",imgform).then(data => {\nif(data.data.success){var path=\"\".concat(baseimageurl,\"/category/\").concat(data.data.data.filename);var fordata={status:formData.status,name:formData.name,parentId:formData.parentId,categoryimg:path};if(formData.status&&formData.name){console.log('database call');axios.post('/api/inventory/add-Category',fordata).then(function(res){if(res.data.success){toggleModal();setchange(!change);NotificationManager.success(res.data.success,'Success',3000,null,null,'');setformData({});}});}}});}else if(formData.status&&formData.name&&formData.parentId){axios.post('/api/inventory/add-Category',formData).then(function(res){if(res.data.success){toggleModal();setchange(!change);NotificationManager.success(res.data.success,'Success',3000,null,null,'');setformData({});}});}};var onChangePicture=function onChangePicture(e){if(e.target.files[0]){var reader=new FileReader();reader.addEventListener('load',function(){setCategoryImage(reader.result);});reader.readAsDataURL(e.target.files[0]);setCategoryImagedata(e.target.files[0]);}};useEffect(function(){axios.get('/api/inventory/get-category').then(function(res){console.log(res.data.data);var categoryList=[];var singleCategory;var _iterator=_createForOfIteratorHelper(res.data.data),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var i=_step.value;if(i.status){singleCategory={label:i.category,value:i.category,key:i.id};categoryList.push(singleCategory);}}}catch(err){_iterator.e(err);}finally{_iterator.f();}setParentcategories(categoryList);});},[]);return/*#__PURE__*/React.createElement(Modal,{isOpen:modalOpen,toggle:toggleModal,wrapClassName:\"modal-right\",backdrop:\"static\"},/*#__PURE__*/React.createElement(ModalHeader,{toggle:toggleModal},/*#__PURE__*/React.createElement(IntlMessages,{id:\"Add New Category\"})),/*#__PURE__*/React.createElement(ModalBody,null,/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\"},/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Category Name\"})),/*#__PURE__*/React.createElement(Input,{onChange:function onChange(e){setformData(_objectSpread(_objectSpread({},formData),{},{name:e.target.value}));}})),/*#__PURE__*/React.createElement(\"div\",{className:\"mt-3\"},/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Parent Category\"})),/*#__PURE__*/React.createElement(Select,{components:{Input:CustomSelectInput},className:\"react-select\",classNamePrefix:\"react-select\",name:\"form-field-name\",options:parentcategories,onChange:function onChange(e){setformData(_objectSpread(_objectSpread({},formData),{},{parentId:e.key}));}})),/*#__PURE__*/React.createElement(Row,{className:\"mt-3\"},/*#__PURE__*/React.createElement(Col,{className:\"sm-6\"},/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(IntlMessages,{id:\"Status\"})),/*#__PURE__*/React.createElement(Select,{components:{Input:CustomSelectInput},className:\"react-select\",classNamePrefix:\"react-select\",name:\"form-field-name\",options:statusOptions,onChange:function onChange(e){setformData(_objectSpread(_objectSpread({},formData),{},{status:e.value}));}}))),/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center justify-content-center flex-column p-3\"},categoryImage?/*#__PURE__*/React.createElement(\"img\",{style:styles.profileImg,src:categoryImage,alt:\"\"}):/*#__PURE__*/React.createElement(\"img\",{src:\"https://icon-library.com/images/category-icon/category-icon-29.jpg\"}),/*#__PURE__*/React.createElement(Label,{className:\"font-weight-bold edit-profile mt-2\",htmlFor:\"imageNameItem\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"Change Picture\"})),/*#__PURE__*/React.createElement(Input,{accept:\"image/*\",onChange:onChangePicture,style:{display:'none'},type:\"file\",name:\"imageNameItem\",id:\"imageNameItem\"}))),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(Button,{color:\"secondary\",outline:true,onClick:toggleModal},/*#__PURE__*/React.createElement(IntlMessages,{id:\"pages.cancel\"})),/*#__PURE__*/React.createElement(Button,{onClick:createCategory,color:\"primary\"},/*#__PURE__*/React.createElement(IntlMessages,{id:\"Create Category\"}))));};export default AddNewCategoryModal;","map":null,"metadata":{},"sourceType":"module"}